<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="io.leangen.graphql.samples.mapper.UserMapper">
    <resultMap id="resultMap" type="io.leangen.graphql.samples.model.User">
        <result column="id" jdbcType="VARCHAR" property="id"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="age" jdbcType="VARCHAR" property="age"/>
    </resultMap>

    <resultMap id="resultMap2" type="io.leangen.graphql.samples.model.UserOwnBook">
        <result column="userid" jdbcType="VARCHAR" property="userId"/>
        <collection property="books" ofType="io.leangen.graphql.samples.model.Book">
            <result column="bookId" jdbcType="VARCHAR" property="id" />
            <result column="context" jdbcType="VARCHAR" property="context" />
        </collection>
    </resultMap>
    <select id="findUserByUserId" parameterType="java.lang.String" resultMap="resultMap">
        select id,name,age from user where id = #{id}
    </select>

    <select id="findAll" parameterType="java.lang.String" resultMap="resultMap">
        SELECT `user`.id userId,book.id bookId,book.context FROM `user` LEFT JOIN book ON  book.user_id = #{id}
    </select>
</mapper>